<!DOCTYPE html>
<html class="no-js">
<head>
  
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://ssgtm.camunda.org/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-PP9MHKW');</script>
  

  
  <meta charset="utf-8" />

  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

  <meta name="viewport" content="width=device-width" />

  <meta name="description" content="documentation of Camunda 7" />
  <meta name="keywords" content="camunda, open source, free, Apache License, Apache 2.0, workflow, BPMN, BPMN 2.0, camunda.org, bpm, BPMS, engine, platform, process, automation, community, documentation" />
  <meta name="author" content="Camunda 7 community" />
  

  <title>Invoke an EJB from a BPMN 2.0 Service Task | docs.camunda.org</title>

  <meta name="generator" content="Hugo 0.54.0" />
  <link rel="shortcut icon" href="../../../test-docs/get-started/img/favicon.ico" type="image/x-icon" />

  

  <link rel="stylesheet" href="../../../test-docs/get-started/css/docs.91d4e2e25acd3c3694c2e139ae987708dbbd89993705dc078bc0f52d6361c7b3.css" integrity="sha256-kdTi4lrNPDaUwuE5rph3CNu9iZk3BdwHi8D1LWNhx7M=">
  
</head>
<body class="">


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PP9MHKW"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<nav class="navbar navbar-fixed-top">
  <div class="navbar-container navbar-top-section">
    <span>Looking for Camunda 8? >></span>
    <a target="_blank" href="https://docs.camunda.io/">Docs</a>
    <a target="_blank" href="https://signup.camunda.com/accounts?utm_source=docs.camunda.org&utm_medium=referral">Create account</a>
    <a target="_blank" href="https://console.cloud.camunda.io/">Sign-In</a>
  </div>
  <div class="navbar-container">
    <div class="navbar-header">
      <a href="../../../">
      <img src="../../../test-docs/get-started/img/orange-C.png" style="width:35;height:35px; padding:0 5px 7px 0;">
        <span class="brand-name">Camunda 7</span>
        <span class="site-name">Docs</span>
      </a>
    </div>

    <ul class="header-menu">
      
      <li  class="active"  ><a href="../../../test-docs/get-started">Get Started</a></li>
      
      <li  ><a href="../../../">Camunda 7</a></li>
      
      <li  ><a href="../../../test-docs/enterprise">Enterprise</a></li>
      
      <li  ><a href="../../../test-docs/security">Security</a></li>
      
    </ul>

    <button class="site-menu-toggle">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <div class="search-field">
      <input type="search" class="search-input" placeholder="Searchâ€¦" />
    </div>

    <ul class="external-menu">
      <li class="external"><a href="https://camunda.org">Camunda.org</a></li>
    </ul>
  </div>
</nav>

<div class="search-results">
  <ul class="results-list">
  </ul>
  <footer>
    <button class="btn btn-default page previous">
      <span class="glyphicon glyphicon-chevron-left"></span>
    </button>

    <button class="search-close btn btn-default">
      <span class="glyphicon glyphicon-remove"></span>
    </button>

    <button class="btn btn-default page next">
      <span class="glyphicon glyphicon-chevron-right"></span>
    </button>
  </footer>
</div>

<div class="search-underlay"></div>

<nav class="site-menu">
  



<div class="version">
  
</div>

<ul class="site-menu-items">
  
    
  <li>
    
      <a href="../../../test-docs/get-started/quick-start/" >Quick Start (Java / JS)</a>
      <ul>
        
          
  <li>
    
      <a href="../../../test-docs/get-started/quick-start/install/" >Download and Installation</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/quick-start/service-task/" >Executable Process</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/quick-start/deploy/" >Deploy the Process</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/quick-start/user-task/" >Involve Humans</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/quick-start/gateway/" >Make It Dynamic</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/quick-start/decision-automation/" >Decision Automation</a>
    
  </li>

        
      </ul>
    
  </li>

  
    
  <li>
    
      <a href="../../../test-docs/get-started/spring-boot/" >Spring Boot</a>
      <ul>
        
          
  <li>
    
      <a href="../../../test-docs/get-started/spring-boot/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/spring-boot/configuration/" >Configuration</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/spring-boot/model/" >Model a Process</a>
    
  </li>

        
      </ul>
    
  </li>

  
    
  <li>
    
      <a href="../../../test-docs/get-started/dmn/" >DMN</a>
      <ul>
        
          
  <li>
    
      <a href="../../../test-docs/get-started/dmn/install/" >Download and Installation</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/dmn/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/dmn/model/" >Create a Decision Table</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/dmn/deploy/" >Evaluate and Deploy the Decision Table</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/dmn/drg/" >Decision Requirements Graph</a>
    
  </li>

        
      </ul>
    
  </li>

  
    
  <li>
    
      <a href="../../../test-docs/get-started/archive/" >Archive</a>
      <ul>
        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/spring/" >Spring Framework</a>
      <ul>
        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/spring/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/spring/embedded-process-engine/" >Embedded Process Engine Configuration</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/spring/service-task/" >Spring Bean Service Task</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/spring/shared-process-engine/" >Shared Process Engine</a>
    
  </li>

        
      </ul>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/" >Java EE 7</a>
      <ul>
        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/install/" >Download and Installation</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/model/" >Model a Process</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/deploy/" >Deploy</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/start-form/" >JSF Start Form</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/service-task/" >EJB Service Task</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/task-form/" >JSF Task Form</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/javaee7/complete-process/" >Complete Process</a>
    
  </li>

        
      </ul>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/java-process-app/" >Java Process Application</a>
      <ul>
        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/java-process-app/install/" >Download and Installation</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/java-process-app/project-setup/" >Project Setup</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/java-process-app/model/" >Model a Process</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/java-process-app/deploy/" >Deploy and Test</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/java-process-app/forms/" >Forms</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/java-process-app/service-task/" >Java Service Task</a>
    
  </li>

        
      </ul>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/rpa/" >RPA Orchestration</a>
      <ul>
        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/rpa/requirements/" >Requirements</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/rpa/installation/" >Installation &amp; Configuration</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/rpa/orchestrating-bots/" >Orchestrating RPA Bots</a>
    
  </li>

        
          
  <li>
    
      <a href="../../../test-docs/get-started/archive/rpa/error-handling/" >Error Handling</a>
    
  </li>

        
      </ul>
    
  </li>

        
      </ul>
    
  </li>

  
    
  <li>
    
      <a href="../../../test-docs/get-started/apache-maven/" >Maven Coordinates</a>
    
  </li>

  
</ul>


<div class="meta">
  <h4 class="header">
    <span class="toggle glyphicon glyphicon-chevron-up"></span>
    Options
  </h4>

  <div class="content">
    <label for="version-select">Version:</label>
    <select id="version-select" data-basepath="/get-started" base-url="/test-docs/get-started/">
      
    </select>
  </div>
</div>



</nav>


<div class="page-wrapper">


<div class="page-content">
  <div class="container-fluid">
    <div class="col-xs-12 content-header">
      <ul class="social">
  <li>
    <a target="_blank" title="Camunda on Twitter" href="//twitter.com/camunda">
      <span class="cam-docs-twitter"></span>
    </a>
  </li>
  <li>
    <a target="_blank" title="Camunda related topics on Stackoverflow" href="//stackoverflow.com/questions/tagged/camunda">
      <span class="cam-docs-stackoverflow"></span>
    </a>
  </li>
  <li>
    <a target="_blank" title="Camunda Forum" href="//forum.camunda.org">
      <span class="cam-docs-chat"></span>
    </a>
  </li>
</ul>

      
<div class="edit-on-github">
  <a target="_blank" href="https://github.com/camunda/camunda-docs-static/tree/master/get-started/content/archive/javaee7/service-task.md"><i>Edit on Github</i> <span class="cam-docs-github"></span></a>
</div>

      <h1 class="page-title">Invoke an EJB from a BPMN 2.0 Service Task</h1>
    </div>

    <div class="col-xs-12 content-text">
      

<p>In this section we learn how to call an EJB from a BPMN 2.0 Service Task.</p>

<h1 id="add-ejb-service-task">Add EJB Service Task</h1>

<p>After the process has been started with the new order as process variables, we want to persist the order to the database and only save the newly generated order id as process variable.</p>

<h2 id="add-an-entity-bean-to-the-process-application">Add an Entity Bean to the Process Application</h2>

<p>To persist the entity with JPA, we add an entity bean to our process application. Create a package <code>org.camunda.bpm.getstarted.pizza</code> and then place the following <code>OrderEntity</code> class into that package:</p>


<div class="note bg-warning docs-warning">
  <h3>Camunda dropped support for handling JPA entities as variables.</h3>
  <p><p>Camunda Automation Platform 7.19 is the last release that supports handling JPA entities as variables</p>

<p>You need to add a process engine plugin to achieve some of the next steps in the guide.
Have a look at the <a href="../../../user-guide/develop/user-guide/update/minor/719-to-720/#breaking-change-discontinue-support-for-handling-jpa-entities-as-variables">7.20 update guide</a> for more information.</p>
</p>
</div>


<pre><code class="language-java">package org.camunda.bpm.getstarted.pizza;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Version;
import java.io.Serializable;

@Entity
public class OrderEntity implements Serializable {

  private static  final long serialVersionUID = 1L;

  @Id
  @GeneratedValue
  protected Long id;

  @Version
  protected long version;

  protected String customer;
  protected String address;
  protected String pizza;
  protected boolean approved;

  public Long getId() {
    return id;
  }

  public void setId(Long id) {
    this.id = id;
  }

  public long getVersion() {
    return version;
  }

  public void setVersion(long version) {
    this.version = version;
  }

  public String getCustomer() {
    return customer;
  }

  public void setCustomer(String customer) {
    this.customer = customer;
  }

  public String getAddress() {
    return address;
  }

  public void setAddress(String address) {
    this.address = address;
  }

  public String getPizza() {
    return pizza;
  }

  public void setPizza(String pizza) {
    this.pizza = pizza;
  }

  public boolean isApproved() {
    return approved;
  }

  public void setApproved(boolean approved) {
    this.approved = approved;
  }
}
</code></pre>

<p>The entity class has to be annotated with <code>@Entity</code> and needs an <code>@Id</code> field. We also add a <code>@Version</code> field to the entity bean. This enables optimistic locking and ensures integrity during merges.</p>

<h2 id="add-an-ejb-to-the-process-application">Add an EJB to the Process Application</h2>

<p>The next step is to add a stateless EJB to the process application which is called by the process. In this EJB we inject the entity manager. It is used to manage our persistent objects during the session.</p>

<p>In the method <code>persistOrder</code>, a new instance of the order entity is created and the order instance will be initialized with the values which are currently saved as process variables. After the newly created instance is flushed to the database, its order id is set and the other process variables are no longer needed, so we remove the order properties and only add the order id as a process variable.</p>

<pre><code class="language-java">package org.camunda.bpm.getstarted.pizza;

import org.camunda.bpm.engine.delegate.DelegateExecution;

import javax.ejb.Stateless;
import javax.inject.Named;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import java.util.Map;

@Stateless
@Named
public class OrderBusinessLogic {

  // Inject the entity manager
  @PersistenceContext
  private EntityManager entityManager;

  public void persistOrder(DelegateExecution delegateExecution) {
    // Create new order instance
    OrderEntity orderEntity = new OrderEntity();

    // Get all process variables
    Map&lt;String, Object&gt; variables = delegateExecution.getVariables();

    // Set order attributes
    orderEntity.setCustomer((String) variables.get(&quot;customer&quot;));
    orderEntity.setAddress((String) variables.get(&quot;address&quot;));
    orderEntity.setPizza((String) variables.get(&quot;pizza&quot;));

    /*
      Persist order instance and flush. After the flush the
      id of the order instance is set.
    */
    entityManager.persist(orderEntity);
    entityManager.flush();

    // Remove no longer needed process variables
    delegateExecution.removeVariables(variables.keySet());

    // Add newly created order id as process variable
    delegateExecution.setVariable(&quot;orderId&quot;, orderEntity.getId());
  }

}
</code></pre>

<h2 id="configure-the-ejb-in-the-process">Configure the EJB in the Process</h2>

<figure class="image">
  <span><img
      src="../img/pizza-order-process-service-task-expression.png"
       /></span>
</figure>


<p>Use the properties view of the Persist Service Task in the process (see screenshot). You need to enter <code>${orderBusinessLogic.persistOrder(execution)}</code> as the <code>Expression</code> property. This will call the <code>persistOrder</code> method of the named EJB with the current execution as parameter.</p>

<p><a href="../deploy/#build-the-process-application">Build</a>, <a href="../deploy/#deploy-to-wildfly">deploy</a> and start the process <code>Order Pizza</code> in <a href="http://localhost:8080/camunda/app/tasklist">Tasklist</a>. Fill out the emerging form. Now the <em>Persist Order</em> step should have been completed automatically. Check that by looking into the logfile of the WildFly server. It will show an entry for the new order entity:</p>

<pre class="console">
  INFO  [stdout] Hibernate: insert into OrderEntity (address, approved, customer, pizza, version, id) values (?, ?, ?, ?, ?, ?)
</pre>


<div class="panel-group gs-download-step-panel" id="gitStep-5">
  <div class="panel panel-success">
    <div class="panel-heading">
      <div class="pull-right">
        <a class="btn btn-success gs-download-step-btn" href="https://github.com/camunda/camunda-get-started-javaee/archive/Step-5.zip">
          <span i class="glyphicon glyphicon-download-alt"></span>
          Source Code Step-5
        </a>
      </div>
      <h4>Catch up: Get the Sources of Step-5.</h4>
      <p class="text-muted">
        <a href="https://github.com/camunda/camunda-get-started-javaee/archive/Step-5.zip">Download as .zip</a>
        or checkout the corresponding tag with <a class="toggle-instructions">Git</a>.
      </p>
    </div>
    <div class="panel-body">
      <p>You can checkout the current state from the <a href="https://github.com/camunda/camunda-get-started-javaee">GitHub repository</a>.</p>
      <p>If you have not cloned the repository yet, please execute the following command:
      <pre class="console">git clone https://github.com/camunda/camunda-get-started-javaee.git</pre>
      </p>
      <p>
      To checkout the current state of the process application please execute the following command:
      <pre class="console">git checkout -f Step-5</pre>
      Or download as archive from <a href="https://github.com/camunda/camunda-get-started-javaee/releases/tag/Step-5">here</a>.
      </p>
    </div>
  </div>
</div>


    </div>
  </div>
</div>

<div class="page-toc">
  <h3>On this Page:</h3>
  <nav id="TableOfContents">
<ul>
<li><a href="#add-ejb-service-task">Add EJB Service Task</a>
<ul>
<li><a href="#add-an-entity-bean-to-the-process-application">Add an Entity Bean to the Process Application</a></li>
<li><a href="#add-an-ejb-to-the-process-application">Add an EJB to the Process Application</a></li>
<li><a href="#configure-the-ejb-in-the-process">Configure the EJB in the Process</a></li>
</ul></li>
</ul>
</nav>
  <div class="docs-banner" style="display:none">
  
  <blockquote>
    <p>
      We are looking for talented people.
    </p>
    <p>
      Check out our <a href="https://camunda.com/career/">open positions</a>.
    </p>
  </blockquote>
</div>

</div>


    
    <footer class="page-footer">
      <div class="row">
        <div class="col-xs-12">

          <p class="pull-right">
            <a href="#" target="_self">Back to top</a>
          </p>

          <p>
            <a href="http://camunda.org">camunda.org</a> and <a href="../../../test-docs/get-started/">docs.camunda.org</a> are both part of Camunda
            <span class="splitter">|</span>
            Built by <a href="http://www.camunda.com">camunda</a> and contributors &mdash; <a href="https://camunda.com/legal/privacy/">Privacy Statement</a> &mdash; camunda Services GmbH &copy; 2025
          </p>
          <p>
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a> The content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
          </p>
        </div>
      </div>
    </footer>
  </div>


  

  <script type="text/javascript" src="../../../test-docs/get-started/js/docs.5475e58434acb556d620a23530a5e7d810d99614ce0019dfc36d72ba6700b3c9.js" integrity="sha256-VHXlhDSstVbWIKI1MKXn2BDZlhTOABnfw21yumcAs8k="></script>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
    _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
    _gaq.push(['_setAccount', 'UA-39060941-1']);
    _gaq.push(['_setDomainName', 'camunda.org']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  
  <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/4513465.js"></script>
  
</body>
</html>

