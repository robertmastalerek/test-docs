<!doctype html><html class=no-js><head><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://ssgtm.camunda.org/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PP9MHKW');</script><meta charset=utf-8><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width"><meta name=description content="documentation of Camunda 7"><meta name=keywords content="camunda,open source,free,Apache License,Apache 2.0,workflow,BPMN,BPMN 2.0,camunda.org,bpm,BPMS,engine,platform,process,automation,community,documentation"><meta name=author content="Camunda 7 community"><meta name=robots content=noindex><title>Implement a JSF Task Form for a BPMN User Task. | docs.camunda.org</title><meta name=generator content="Hugo 0.54.0"><link rel="shortcut icon" href=https://robertmastalerek.github.io/test-docs/get-started/img/favicon.ico type=image/x-icon><link rel=stylesheet href=https://robertmastalerek.github.io/test-docs/get-started/css/docs.91d4e2e25acd3c3694c2e139ae987708dbbd89993705dc078bc0f52d6361c7b3.css integrity="sha256-kdTi4lrNPDaUwuE5rph3CNu9iZk3BdwHi8D1LWNhx7M="><link rel=canonical href=https://robertmastalerek.github.io/test-docs/get-started/https://robertmastalerek.github.io/test-docs/get-started/archive/javaee7/task-form/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PP9MHKW" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><nav class="navbar navbar-fixed-top"><div class="navbar-container navbar-top-section"><span>Looking for Camunda 8? >></span>
<a target=_blank href=https://docs.camunda.io/>Docs</a>
<a target=_blank href="https://signup.camunda.com/accounts?utm_source=docs.camunda.org&utm_medium=referral">Create account</a>
<a target=_blank href=https://console.cloud.camunda.io/>Sign-In</a></div><div class=navbar-container><div class=navbar-header><a href=https://robertmastalerek.github.io/test-docs/get-started/><img src=https://robertmastalerek.github.io/test-docs/get-started/img/orange-C.png style="width:35;height:35px;padding:0 5px 7px 0">
<span class=brand-name>Camunda 7</span>
<span class=site-name>Docs</span></a></div><ul class=header-menu><li><a href=/test-docs/get-started/>Get Started</a></li><li><a href=/test-docs/>Camunda 7</a></li><li><a href=enterprise>Enterprise</a></li><li><a href=security>Security</a></li></ul><button class=site-menu-toggle>
<span></span><span></span><span></span></button><div class=search-field><input type=search class=search-input placeholder=Searchâ€¦></div><ul class=external-menu><li class=external><a href=https://camunda.org>Camunda.org</a></li></ul></div></nav><div class=search-results><ul class=results-list></ul><footer><button class="btn btn-default page previous">
<span class="glyphicon glyphicon-chevron-left"></span></button>
<button class="search-close btn btn-default">
<span class="glyphicon glyphicon-remove"></span></button>
<button class="btn btn-default page next">
<span class="glyphicon glyphicon-chevron-right"></span></button></footer></div><div class=search-underlay></div><nav class=site-menu><div class="version versioned"><span class=number><a>develop</a>
(7.23)</span></div><ul class=site-menu-items><li><a href=/test-docs/get-started/quick-start/>Quick Start (Java / JS)</a><ul><li><a href=/test-docs/get-started/quick-start/install/>Download and Installation</a></li><li><a href=/test-docs/get-started/quick-start/service-task/>Executable Process</a></li><li><a href=/test-docs/get-started/quick-start/deploy/>Deploy the Process</a></li><li><a href=/test-docs/get-started/quick-start/user-task/>Involve Humans</a></li><li><a href=/test-docs/get-started/quick-start/gateway/>Make It Dynamic</a></li><li><a href=/test-docs/get-started/quick-start/decision-automation/>Decision Automation</a></li></ul></li><li><a href=/test-docs/get-started/spring-boot/>Spring Boot</a><ul><li><a href=/test-docs/get-started/spring-boot/project-setup/>Project Setup</a></li><li><a href=/test-docs/get-started/spring-boot/configuration/>Configuration</a></li><li><a href=/test-docs/get-started/spring-boot/model/>Model a Process</a></li></ul></li><li><a href=/test-docs/get-started/dmn/>DMN</a><ul><li><a href=/test-docs/get-started/dmn/install/>Download and Installation</a></li><li><a href=/test-docs/get-started/dmn/project-setup/>Project Setup</a></li><li><a href=/test-docs/get-started/dmn/model/>Create a Decision Table</a></li><li><a href=/test-docs/get-started/dmn/deploy/>Evaluate and Deploy the Decision Table</a></li><li><a href=/test-docs/get-started/dmn/drg/>Decision Requirements Graph</a></li></ul></li><li><a href=/test-docs/get-started/archive/>Archive</a><ul><li><a href=/test-docs/get-started/archive/spring/>Spring Framework</a><ul><li><a href=/test-docs/get-started/archive/spring/project-setup/>Project Setup</a></li><li><a href=/test-docs/get-started/archive/spring/embedded-process-engine/>Embedded Process Engine Configuration</a></li><li><a href=/test-docs/get-started/archive/spring/service-task/>Spring Bean Service Task</a></li><li><a href=/test-docs/get-started/archive/spring/shared-process-engine/>Shared Process Engine</a></li></ul></li><li><a href=/test-docs/get-started/archive/javaee7/>Java EE 7</a><ul><li><a href=/test-docs/get-started/archive/javaee7/install/>Download and Installation</a></li><li><a href=/test-docs/get-started/archive/javaee7/project-setup/>Project Setup</a></li><li><a href=/test-docs/get-started/archive/javaee7/model/>Model a Process</a></li><li><a href=/test-docs/get-started/archive/javaee7/deploy/>Deploy</a></li><li><a href=/test-docs/get-started/archive/javaee7/start-form/>JSF Start Form</a></li><li><a href=/test-docs/get-started/archive/javaee7/service-task/>EJB Service Task</a></li><li><a href=/test-docs/get-started/archive/javaee7/task-form/>JSF Task Form</a></li><li><a href=/test-docs/get-started/archive/javaee7/complete-process/>Complete Process</a></li></ul></li><li><a href=/test-docs/get-started/archive/java-process-app/>Java Process Application</a><ul><li><a href=/test-docs/get-started/archive/java-process-app/install/>Download and Installation</a></li><li><a href=/test-docs/get-started/archive/java-process-app/project-setup/>Project Setup</a></li><li><a href=/test-docs/get-started/archive/java-process-app/model/>Model a Process</a></li><li><a href=/test-docs/get-started/archive/java-process-app/deploy/>Deploy and Test</a></li><li><a href=/test-docs/get-started/archive/java-process-app/forms/>Forms</a></li><li><a href=/test-docs/get-started/archive/java-process-app/service-task/>Java Service Task</a></li></ul></li><li><a href=/test-docs/get-started/archive/rpa/>RPA Orchestration</a><ul><li><a href=/test-docs/get-started/archive/rpa/requirements/>Requirements</a></li><li><a href=/test-docs/get-started/archive/rpa/installation/>Installation &amp; Configuration</a></li><li><a href=/test-docs/get-started/archive/rpa/orchestrating-bots/>Orchestrating RPA Bots</a></li><li><a href=/test-docs/get-started/archive/rpa/error-handling/>Error Handling</a></li></ul></li></ul></li><li><a href=/test-docs/get-started/apache-maven/>Maven Coordinates</a></li></ul><div class=meta><h4 class=header><span class="toggle glyphicon glyphicon-chevron-up"></span>Options</h4><div class=content><label for=version-select>Version:</label>
<select id=version-select data-basepath=/manual base-url=https://robertmastalerek.github.io/test-docs/get-started/>
<option>latest</option>
<option>7.22</option>
<option>7.21</option>
<option>7.20</option>
<option>7.19</option>
<option>7.18</option>
<option>7.17</option>
<option>7.16</option>
<option>7.15</option>
<option>7.14</option>
<option>7.13</option>
<option>7.12</option>
<option>7.11</option>
<option>7.10</option>
<option>7.9</option>
<option>7.8</option>
<option>7.7</option>
<option>7.6</option>
<option>7.5</option>
<option>7.4</option>
<option>7.3</option>
<option>7.2</option>
<option>7.1</option>
<option>7.0</option>
<option selected>develop</option></select></div></div></nav><div class=page-wrapper><div class=page-content><div class=container-fluid><div class="col-xs-12 content-header"><ul class=social><li><a target=_blank title="Camunda on Twitter" href=//twitter.com/camunda><span class=cam-docs-twitter></span></a></li><li><a target=_blank title="Camunda related topics on Stackoverflow" href=//stackoverflow.com/questions/tagged/camunda><span class=cam-docs-stackoverflow></span></a></li><li><a target=_blank title="Camunda Forum" href=//forum.camunda.org><span class=cam-docs-chat></span></a></li></ul><div class=edit-on-github><a target=_blank href=https://github.com/camunda/camunda-docs-manual/tree/master/content/archive/javaee7/task-form.md><i>Edit on Github</i> <span class=cam-docs-github></span></a></div><h1 class=page-title>Implement a JSF Task Form for a BPMN User Task.</h1></div><div class="col-xs-12 content-text"><p>Now we add a task form and configure it in the BPMN 2.0 process, then, re-deploy the application and go to the Camunda Tasklist to see the JSF form.</p><figure class=image><span><img src=../img/approve-order.png></span></figure><p>After the order has been persisted, a user can approve the order. For that, a task form is needed to display the order information and backend logic to fetch and update business objects.</p><h1 id=add-a-cdi-controller-bean>Add a CDI Controller Bean</h1><p>To update the persisted entity we use a named CDI Bean <code>ApproveOrderController</code>. To gather the persisted order entity, we get the order id from the process variables of the <code>businessProcess</code>. With the id we can load the order entity through the order business logic. After the order has been updated, the detached entity state is merged by the order business logic.</p><pre><code class=language-java>package org.camunda.bpm.getstarted.pizza;

import org.camunda.bpm.engine.cdi.BusinessProcess;
import org.camunda.bpm.engine.cdi.jsf.TaskForm;

import javax.enterprise.context.ConversationScoped;
import javax.inject.Inject;
import javax.inject.Named;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import java.io.IOException;
import java.io.Serializable;

@Named
@ConversationScoped
public class ApproveOrderController implements Serializable {

  private static  final long serialVersionUID = 1L;

  // Inject the BusinessProcess to access the process variables
  @Inject
  private BusinessProcess businessProcess;

  // Inject the EntityManager to access the persisted order
  @PersistenceContext
  private EntityManager entityManager;

  // Inject the OrderBusinessLogic to update the persisted order
  @Inject
  private OrderBusinessLogic orderBusinessLogic;

  // Caches the OrderEntity during the conversation
  private OrderEntity orderEntity;

  public OrderEntity getOrderEntity() {
    if (orderEntity == null) {
      // Load the order entity from the database if not already cached
      orderEntity = orderBusinessLogic.getOrder((Long) businessProcess.getVariable(&quot;orderId&quot;));
    }
    return orderEntity;
  }

  public void submitForm() throws IOException {
    // Persist updated order entity and complete task form
    orderBusinessLogic.mergeOrderAndCompleteTask(orderEntity);
  }
}
</code></pre><h1 id=extend-order-business-logic>Extend Order Business Logic</h1><p>The order business logic is extended to provide a method to load an order entity from the database by order id, to merge a detached order entity and to complete the task form. For that, the task form is injected, which is provided by the Camunda CDI artifact.</p><p>Please note that the merging of the detached order entity and the completion of the task form are intentionally placed in one method. This ensures that both operations are executed in a single transaction. An error during that transaction will rollback both changes.</p><pre><code class=language-java>@Stateless
@Named
public class OrderBusinessLogic {

  // ...

  // Inject task form available through the Camunda cdi artifact
  @Inject
  private TaskForm taskForm;

  public void persistOrder(DelegateExecution delegateExecution) {
    // ...
  }

  public OrderEntity getOrder(Long orderId) {
    // Load order entity from database
    return entityManager.find(OrderEntity.class, orderId);
  }

  /*
    Merge updated order entity and complete task form in one transaction. This ensures
    that both changes will rollback if an error occurs during transaction.
   */
  public void mergeOrderAndCompleteTask(OrderEntity orderEntity) {
    // Merge detached order entity with current persisted state
    entityManager.merge(orderEntity);
    try {
      // Complete user task from
      taskForm.completeTask();
    } catch (IOException e) {
      // Rollback both transactions on error
      throw new RuntimeException(&quot;Cannot complete task&quot;, e);
    }
  }

}
</code></pre><h1 id=create-a-jsf-form-task-form>Create a JSF Form Task Form</h1><p>Add a file named <code>approveorder.xhtml</code> to the <code>src/main/webapp</code> folder. Add the following content:</p><pre><code class=language-html>&lt;!DOCTYPE HTML&gt;
&lt;html lang=&quot;en&quot; xmlns=&quot;http://www.w3.org/1999/xhtml&quot;
  xmlns:ui=&quot;http://java.sun.com/jsf/facelets&quot;
  xmlns:h=&quot;http://java.sun.com/jsf/html&quot;
  xmlns:f=&quot;http://java.sun.com/jsf/core&quot;&gt;

  &lt;f:view&gt;
    &lt;f:metadata&gt;
      &lt;!-- Start working on a task. Task Id is read internally from
       request parameters and cached in the CDI conversation scope.
      --&gt;

    &lt;f:event type=&quot;preRenderView&quot; listener=&quot;#{camundaTaskForm.startTaskForm()}&quot; /&gt;
  &lt;/f:metadata&gt;
  &lt;h:head&gt;
    &lt;title&gt;Approve Order&lt;/title&gt;
  &lt;/h:head&gt;
  &lt;h:body&gt;
    &lt;h1&gt;Order:&lt;/h1&gt;
    &lt;p&gt;Customer: #{approveOrderController.orderEntity.customer}&lt;/p&gt;
    &lt;p&gt;Address: #{approveOrderController.orderEntity.address}&lt;/p&gt;
    &lt;p&gt;Pizza: #{approveOrderController.orderEntity.pizza}&lt;/p&gt;
    &lt;h:form id=&quot;submitForm&quot;&gt;
      &lt;h:outputLabel&gt;Approve Order?&lt;/h:outputLabel&gt;
      &lt;h:selectBooleanCheckbox value=&quot;#{approveOrderController.orderEntity.approved}&quot;/&gt;&lt;br/&gt;
      &lt;h:commandButton id=&quot;submit_button&quot; value=&quot;Approve Order&quot; action=&quot;#{approveOrderController.submitForm()}&quot; /&gt;
    &lt;/h:form&gt;
  &lt;/h:body&gt;
  &lt;/f:view&gt;
&lt;/html&gt;
</code></pre><p>The JSF view displays the order properties and provides a checkbox to approve the order on submit. Additionally, an event listener is configured which is triggered before the view is rendered. It will call the <code>camundaTaskForm.startTaskForm()</code> method which extracts the task id from the URL and starts a conversation for the task form.</p><p>When the user approves or disapproves the order, it is directly set on the cached order entity.</p><p>On form submit, the <code>approveOrderController.submitForm()</code> method calls the EJB <code>mergeOrderAndCompleteTask</code> method with the cached order entity. The EJB will merge the updated order entity if necessary and completes the task form.</p><h1 id=configure-the-task-form-in-the-process>Configure the Task Form in the Process</h1><figure class=image><span><img src=../img/pizza-order-process-task-form.png></span></figure><p>Open the process with the modeler. Click on the <em>Approve Order</em> user task. In the properties view, set the <code>Form Key</code> property to <code>app:approveorder.jsf</code>. This means that we want to use an external JSF form and that the form is loaded from the application.</p><h1 id=configure-the-conditional-sequence-flows-in-the-process>Configure the Conditional Sequence Flows in the Process</h1><figure class=image><span><img src=../img/pizza-order-process-no.png></span></figure><p>Open the process with the modeler. In the properties view, set the <code>Condition</code> property of the conditional sequence flows after the exclusive gateway to <code>${orderBusinessLogic.getOrder(orderId).approved}</code> respectively <code>${not orderBusinessLogic.getOrder(orderId).approved}</code>.</p><p>When you are done, save all resources, <a href=../deploy/#build-the-process-application>perform a Maven build</a>, and <a href=../deploy/#deploy-to-wildfly>redeploy</a> the process application. Start the process <code>Order Pizza</code> in <a href=http://localhost:8080/camunda/app/tasklist>Tasklist</a>. Fill out the emerging form. Select the <code>All Tasks</code> element on the left side of Tasklist. An <code>Approve Order</code> task should then be listed in the tasklist. Go to the task and press on <button class="btn btn-xs">
<i class="glyphicon glyphicon-user"></i>Claim</button>
. Now you can approve the pizza order.</p><div class="panel-group gs-download-step-panel" id=gitStep-6><div class="panel panel-success"><div class=panel-heading><div class=pull-right><a class="btn btn-success gs-download-step-btn" href=https://github.com/camunda/camunda-get-started-javaee/archive/Step-6.zip><span i class="glyphicon glyphicon-download-alt"></span>Source Code Step-6</a></div><h4>Catch up: Get the Sources of Step-6.</h4><p class=text-muted><a href=https://github.com/camunda/camunda-get-started-javaee/archive/Step-6.zip>Download as .zip</a>
or checkout the corresponding tag with <a class=toggle-instructions>Git</a>.</p></div><div class=panel-body><p>You can checkout the current state from the <a href=https://github.com/camunda/camunda-get-started-javaee>GitHub repository</a>.</p><p>If you have not cloned the repository yet, please execute the following command:<pre class=console>git clone https://github.com/camunda/camunda-get-started-javaee.git</pre></p><p>To checkout the current state of the process application please execute the following command:<pre class=console>git checkout -f Step-6</pre>Or download as archive from <a href=https://github.com/camunda/camunda-get-started-javaee/releases/tag/Step-6>here</a>.</p></div></div></div></div></div></div><div class=page-toc><h3>On this Page:</h3><nav id=TableOfContents><ul><li><a href=#add-a-cdi-controller-bean>Add a CDI Controller Bean</a></li><li><a href=#extend-order-business-logic>Extend Order Business Logic</a></li><li><a href=#create-a-jsf-form-task-form>Create a JSF Form Task Form</a></li><li><a href=#configure-the-task-form-in-the-process>Configure the Task Form in the Process</a></li><li><a href=#configure-the-conditional-sequence-flows-in-the-process>Configure the Conditional Sequence Flows in the Process</a></li></ul></nav><div class=docs-banner style=display:none><blockquote><p>We are looking for talented people.</p><p>Check out our <a href=https://camunda.com/career/>open positions</a>.</p></blockquote></div></div><footer class=page-footer><div class=row><div class=col-xs-12><p class=pull-right><a href=# target=_self>Back to top</a></p><p><a href=http://camunda.org>camunda.org</a> and <a href=https://robertmastalerek.github.io/test-docs/get-started/>docs.camunda.org</a> are both part of Camunda
<span class=splitter>|</span>
Built by <a href=http://www.camunda.com>camunda</a> and contributors &mdash; <a href=https://camunda.com/legal/privacy/>Privacy Statement</a> &mdash; camunda Services GmbH &copy; 2025</p><p><a rel=license href=http://creativecommons.org/licenses/by-sa/3.0/><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-sa/3.0/80x15.png></a> The content on this site is licensed under a <a rel=license href=http://creativecommons.org/licenses/by-sa/3.0/>Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</p></div></div></footer></div><script type=text/javascript src=https://robertmastalerek.github.io/test-docs/get-started/js/docs.5475e58434acb556d620a23530a5e7d810d99614ce0019dfc36d72ba6700b3c9.js integrity="sha256-VHXlhDSstVbWIKI1MKXn2BDZlhTOABnfw21yumcAs8k="></script><script type=text/javascript>var _gaq=_gaq||[];var pluginUrl='//www.google-analytics.com/plugins/ga/inpage_linkid.js';_gaq.push(['_require','inpage_linkid',pluginUrl]);_gaq.push(['_setAccount','UA-39060941-1']);_gaq.push(['_setDomainName','camunda.org']);_gaq.push(['_trackPageview']);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();</script><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/4513465.js></script></body></html>